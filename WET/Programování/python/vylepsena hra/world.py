import pygame 
from items import Desk, Boost, Coin
from pytmx.util_pygame import load_pygame
from monster import Monster
from player import Player
from monster1 import Monster1

class World:
    def __init__(self, path, screen, sprite_groups):
        self.path = path
        self.sprite_groups = sprite_groups
        self.data = load_pygame(path)
        self.ground = self.data.get_layer_by_name("ground")
        for layer in self.data.visible_layers:
            setattr(self, layer.name, self.data.get_layer_by_name(layer.name))

        for key,group in sprite_groups.items():
            setattr(self,key, group)

        self.background = pygame.Surface((self.data.width*self.data.tilewidth, self.data.height*self.data.tileheight))
        self.screen = screen
        self.init_items()
        
        
        
    def draw_background(self):
        for x,y, image in self.ground.tiles():
            self.background.blit(image,(x*self.data.tilewidth,y* self.data.tileheight))
            self.screen.blit(self.background,(0,0))

    def init_items(self):
        self.create_items(self.furniture, Desk, self.desk_group)
        self.create_items(self.spawn_coins, Coin, self.coins_group)
        self.create_items(self.spawn_powerups, Boost, self.boost_group)
        self.create_monstersh(self.spawn_enemies_h, self.monsters_group)
        self.create_monstersv(self.spawn_enemies_v, self.monsters_group)
        self.create_player(self.spawn_player,self.player_group)
    def create_items(self, layer, item_class, group):
        for item in layer:
            new_item = item_class(item.image, item.width, item.height, (item.x, item.y))
            group.add(new_item)
            self.all_group.add(new_item)

    def create_monstersh(self, layer, group):
         for monster in layer:
            new_monster = Monster((monster.x, monster.y))
            group.add(new_monster)
            self.all_group.add(new_monster)
    def create_monstersv(self, layer, group):
         for monster in layer:
            new_monster = Monster1((monster.x, monster.y))
            group.add(new_monster)
            self.all_group.add(new_monster)

    def create_player(self, layer,group):
        for player in layer:
            new_player = Player((player.x, player.y), self.sprite_groups)
            group.add(new_player)
            self.all_group.add(new_player)

























































































































































































































































































































































































































































































































































































































































































